{% macro render_field_with_errors(field) %}
    {% set cls = 'form-error' if field.errors else '' %}
    <label>
      {{ field.label.text }}
      {%- if field.flags.required %}*{% endif %}
    </label>
    {{ field(class=cls, **kwargs)|safe }}
    {% if field.errors %}
      {% for error in field.errors %}
        <p class="form-error-msg">{{ error }}</p>
      {% endfor %}
    {% endif %}
{% endmacro %}
